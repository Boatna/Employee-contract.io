<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ô‡∏±‡∏¢ ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á PDF</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
/* CSS ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô */
body, .a4 {
  font-family: 'Sarabun', sans-serif;
}
body {
  font-family: 'TH Sarabun', sans-serif;
  font-weight: 400;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: #f0f9ff;
  font-size: 16px;
  line-height: 1.6;
}
.a4 {
  width: 210mm;
  min-height: 297mm;
  padding: 15mm;
  background: #fff;
  box-shadow: 0 0 15px rgba(0,0,0,0.1);
  margin: 20px auto;
  box-sizing: border-box;
  border-radius: 8px;
  font-size: 16px;
  line-height: 1.6;
  position: relative;
}
.form-group { margin-bottom: 1rem; }
.label { 
  display: block; 
  font-size: 16px; 
  font-weight: 600; 
  margin-bottom: 0.5rem;
  color: #1e293b;
}
.input {
  width: 100%;
  border: 1px solid #cbd5e1;
  border-radius: 0.5rem;
  padding: 0.75rem 1rem;
  font-size: 16px;
  transition: all 0.3s ease;
  font-family: 'TH Sarabun', sans-serif;
}
.input:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
}
.btn {
  padding: 0.75rem 1.5rem;
  border-radius: 0.5rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 16px;
  border: none;
  font-family: 'TH Sarabun', sans-serif;
}
.btn-primary {
  background: linear-gradient(to right, #2563eb, #4f46e5);
  color: white;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.btn-primary:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.btn-secondary {
  background: linear-gradient(to right, #475569, #1e293b);
  color: white;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.btn-secondary:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.btn-danger {
  background: linear-gradient(to right, #dc2626, #b91c1c);
  color: white;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.btn-danger:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.section-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: #0f172a;
  margin-bottom: 1.5rem;
  border-bottom: 2px solid #dbeafe;
  padding-bottom: 0.5rem;
  display: flex;
  align-items: center;
}
.section-title svg {
  margin-right: 0.5rem;
}
.contract-preview {
  background: white;
  border-radius: 0.5rem;
  border: 1px solid #e2e8f0;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.clause {
  margin-top: 0.5rem;
  text-align: justify;
  /* text-indent: 2em; */ /* ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ */
  line-height: 1.8;
}
.clause-number {
  font-weight: 600;
  color: #000000;
}
.signature-box {
  height: 80px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  border: 2px dashed #94a3b8;
  border-radius: 0.5rem;
  background-color: #f1f5f9;
  color: #64748b;
  font-style: italic;
  transition: all 0.3s ease;
}
.signature-box.has-signature {
  border: 2px solid #1e40af;
  background-color: #eff6ff;
  color: #1e3a8a;
}
.signature-box img {
  max-height: 60px;
  max-width: 180px;
  object-fit: contain;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));
}
.contract-content {
  font-size: 16px;
  line-height: 1.8;
  color: #000;
  font-family: 'Sarabun', sans-serif;
}
.contract-content p,
.letter-paragraph {
  margin: 0.8rem 0;
  text-align: justify;
  /* text-indent: 2em; */ /* ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ */
}
.contract-content .font-bold {
  font-weight: 700;
}
/* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏û‡∏¥‡∏°‡∏û‡πå */
@page {
  size: A4;
  margin: 0;
}
@media print {
  body {
    background-color: #fff;
  }
  .container {
    max-width: none;
    padding: 0;
  }
  .card:first-child {
    display: none;
  }
  .a4 {
    width: 210mm;
    height: 297mm;
    margin: 0 !important;
    box-shadow: none;
    font-family: 'TH Sarabun', sans-serif;
    padding: 15mm;
    box-sizing: border-box;
  }
  .contract-content {
    font-size: 14px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö PDF */
    line-height: 1.6;
  }
  .btn-group, .section-title, .form-container {
    display: none;
  }
  .signature-box-print.has-signature {
    border-bottom: 1px solid #000 !important;
  }
  .signature-box-print.has-signature img {
    display: block !important;
    max-height: 50px;
    margin: 0 auto;
  }
  /* ========== START: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö PDF ========== */
  .government-letter {
    font-size: 14px; /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö PDF */
  }
  .letter-date {
    font-size: 14px;
  }
  .letter-paragraph {
    margin: 0.5rem 0; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á */
    font-size: 14px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ */
    /* text-indent: 2em; */ /* ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏ô PDF */
  }
  .letter-section-title {
    font-size: 1.1rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ */
  }
  .letter-list-item {
    font-size: 14px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ */
  }
  .signature-label {
    font-size: 14px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏õ‡πâ‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ */
  }
  .signature-date {
    font-size: 12px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô */
  }
  .official-advice-title {
    font-size: 1.1rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ */
  }
  .official-advice-item {
    font-size: 12px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏ô‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ */
  }
  /* ========== END: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö PDF ========== */
}
/* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Layout */
.grid-4 {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  gap: 0.5rem;
}
.form-container {
  background-color: #f0f9ff;
  padding: 1.5rem;
  border-radius: 0.75rem;
  border: 1px solid #bae6fd;
}
.form-section {
  margin-bottom: 1.5rem;
  padding: 1.5rem;
  background-color: white;
  border-radius: 0.75rem;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  border: 1px solid #e0f2fe;
}
.form-section-title {
  font-size: 1.25rem;
  font-weight: 600;
  color: #0369a1;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid #bae6fd;
}
.signature-section {
  margin-top: 1.5rem;
}
.signature-section-title {
  font-size: 1.25rem;
  font-weight: 600;
  color: #0369a1;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid #bae6fd;
}
.signature-pad-container {
  border: 1px solid #bae6fd;
  border-radius: 0.5rem;
  padding: 0.75rem;
  background-color: #f0f9ff;
  transition: box-shadow 0.3s ease;
}
.signature-pad-container:hover {
  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
}
.signature-pad {
  border: 1px solid #cbd5e1;
  border-radius: 0.375rem;
  background-color: white;
  width: 100%;
  height: 150px;
}
.signature-controls {
  display: flex;
  gap: 0.5rem;
  margin-top: 0.5rem;
}
.signature-btn {
  padding: 0.5rem 1rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  cursor: pointer;
  border: 1px solid #cbd5e1;
  transition: all 0.3s ease;
  font-family: 'TH Sarabun', sans-serif;
}
.signature-btn.clear {
  background-color: #fee2e2;
  color: #dc2626;
}
.signature-btn.clear:hover {
  background-color: #fecaca;
}
.signature-btn.save {
  background-color: #bbf7d0;
  color: #166534;
}
.signature-btn.save:hover {
  background-color: #86efac;
}
.signature-status {
  margin-top: 0.5rem;
  font-size: 0.875rem;
  color: #64748b;
  text-align: center;
  font-style: italic;
}
.signature-status.signed {
  color: #16a34a;
  font-weight: 600;
  font-style: normal;
}
.note-box {
  background-color: #fffbeb;
  border: 1px solid #fde68a;
  border-radius: 0.5rem;
  padding: 1rem;
  margin: 1rem 0;
}
.btn-group {
  display: flex;
  gap: 1rem;
  margin-top: 1.5rem;
  flex-wrap: wrap;
}
/* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Notification */
.notification {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 1rem;
  border-radius: 0.5rem;
  background-color: #16a34a;
  color: white;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  transform: translateX(100%);
  transition: transform 0.3s ease;
  z-index: 1000;
  font-family: 'TH Sarabun', sans-serif;
  font-size: 16px;
}
.notification.show {
  transform: translateX(0);
}
.notification.error {
  background-color: #dc2626;
}
/* ========== CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Checkbox ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏•‡πâ‡∏ß ========== */
/* ‡∏ã‡πà‡∏≠‡∏ô input checkbox ‡∏à‡∏£‡∏¥‡∏á */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}
/* ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡∏≠‡∏á label ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏ó‡∏ô checkbox */
.official-checkbox-label {
  display: inline-flex;
  align-items: center;
  cursor: pointer;
  font-size: 16px;
  color: #0f172a;
}
/* ‡∏ï‡∏±‡∏ß‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ checkbox (‡∏Å‡∏£‡∏≠‡∏ö‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°) */
.official-checkbox-indicator {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 2px solid #000;
  margin-right: 8px;
  flex-shrink: 0;
  position: relative;
  background-color: white;
  transition: background-color 0.2s ease;
  box-sizing: border-box;
}
/* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠ hover */
.official-checkbox-label:hover .official-checkbox-indicator {
  background-color: #f8fafc;
}
.sr-only:checked + .official-checkbox-label .official-checkbox-indicator::after {
  content: "";
  display: block;
  width: 100%;
  height: 100%;
  background-color: #000;
  position: absolute;
  top: 0;
  left: 0;
  padding: 0;
  margin: 0;
  box-sizing: border-box;
  border-radius: 2px;
}
@media print {
  .sr-only:checked + .official-checkbox-label .official-checkbox-indicator {
    border: 2px solid #000;
    background-color: #fff;
  }
  .sr-only:checked + .official-checkbox-label .official-checkbox-indicator::after {
    content: "" !important;
    display: block !important;
    background-color: #000 !important;
    border-radius: 2px;
  }
}
/* ========== CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏•‡πâ‡∏ß) ========== */
.government-letter {
  min-height: 100%;
  font-size: 14px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ */
}
.letter-header {
  text-align: center;
  margin-bottom: 1.5rem;
}
.letter-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: #0f172a;
  text-decoration: underline;
  text-underline-offset: 4px;
  text-decoration-thickness: 2px;
}
.letter-date {
  text-align: right;
  font-weight: 600;
  color: #0f172a;
  margin-bottom: 1.5rem;
  font-size: 14px; /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏•‡∏±‡∏Å */
}
.letter-paragraph {
  margin: 0.5rem 0; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö */
  line-height: 1.6;
  font-size: 14px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ */
  text-align: justify;
  /* text-indent: 2em; */ /* ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ */
}
.letter-section {
  margin: 1rem 0; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö */
}
.letter-section-title {
  font-weight: 700;
  color: #0f172a;
  margin-bottom: 0.6rem;
  font-size: 1.1rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
}
.letter-list {
  margin-top: 0.6rem;
}
.letter-list-item {
  margin-bottom: 0.4rem;
  line-height: 1.5;
  font-size: 14px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ */
}
.letter-signature-section {
  margin-top: 1.8rem;
}
.signature-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.8rem;
  margin-top: 1rem;
}
.signature-item {
  text-align: center;
}
.signature-label {
  margin-top: 0.4rem;
  font-weight: 600;
  font-size: 14px; /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á */
}
.signature-date {
  margin-top: 0.2rem;
  font-size: 12px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á */
  color: #64748b;
}
.official-advice {
  margin-top: 1.8rem;
  padding-top: 0.8rem;
  border-top: 1px solid #e2e8f0;
}
.official-advice-title {
  font-weight: 700;
  color: #0f172a;
  margin-bottom: 0.6rem;
  font-size: 1.1rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
}
.advice-list {
  margin-top: 0.6rem;
}
.official-advice-item {
  margin-bottom: 0.4rem;
  line-height: 1.5;
  font-size: 12px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á */
}
.signature-box-print {
  min-height: 80px;
  border-bottom: 1px solid #000;
  margin-top: 2rem;
  text-align: center;
  padding-top: 0.5rem;
  display: flex;
  justify-content: center;
  align-items: center;
}
.signature-box-print.has-signature {
  border-bottom: 1px solid #000;
}
/* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Spinner */
.spinner {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 2px solid #ffffff;
  border-radius: 50%;
  border-top-color: transparent;
  animation: spin 1s ease-in-out infinite;
}
@keyframes spin {
  to { transform: rotate(360deg); }
}
/* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Header ‡πÅ‡∏•‡∏∞ Card */
.header-bg {
  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
  color: white;
  padding: 2rem 0;
  margin-bottom: 2rem;
  border-radius: 0 0 1rem 1rem;
}
.header-title {
  font-size: 2rem;
  font-weight: 700;
  text-align: center;
  text-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.card {
  background: white;
  border-radius: 1rem;
  box-shadow: 0 4px 6px rgba(0,0,0,0.05);
  padding: 1.5rem;
  margin-bottom: 2rem;
  border: 1px solid #e0f2fe;
}
/* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠ */
.signature-tutorial {
  background-color: #f0f9ff;
  border: 1px solid #7dd3fc;
  border-radius: 0.5rem;
  padding: 1rem;
  margin-top: 1rem;
}
.signature-tutorial-title {
  font-weight: 600;
  color: #0369a1;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
}
.signature-tutorial-title svg {
  margin-right: 0.5rem;
}
.signature-tutorial-list {
  list-style-type: disc;
  padding-left: 1.5rem;
}
.signature-tutorial-item {
  margin-bottom: 0.5rem;
  font-size: 14px;
  color: #334155;
}
.signature-quality-notice {
  background-color: #fffbeb;
  border: 1px solid #fde68a;
  border-radius: 0.375rem;
  padding: 0.5rem;
  margin-top: 0.5rem;
  font-size: 0.75rem;
  color: #92400e;
}
/* ========== CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Responsive Design ========== */
@media (max-width: 768px) {
  .a4 {
    width: 100%;
    min-height: auto;
    padding: 10mm;
  }
  .grid-4 {
    grid-template-columns: 1fr 1fr;
  }
  .signature-grid {
    grid-template-columns: 1fr;
  }
}
@media (max-width: 480px) {
  .grid-4 {
    grid-template-columns: 1fr;
  }
  .signature-pad-container {
    margin-bottom: 1rem;
  }
  .btn-group {
    flex-direction: column;
  }
  .btn {
    width: 100%;
    margin-bottom: 0.5rem;
  }
  .signature-pad {
    height: 120px;
  }
}
</style>
</head>
<body>
<div class="header-bg">
  <div class="container mx-auto px-4">
    <h1 class="header-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ô‡∏±‡∏¢</h1>
  </div>
</div>
<div class="container mx-auto px-4 py-8">
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏° -->
    <div class="card">
      <h2 class="section-title">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©
      </h2>
      <form id="contractForm" class="form-container">
        <div class="form-section">
          <h3 class="form-section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h3>
          <div class="grid grid-cols-1 gap-4">
            <div class="input-group">
              <label for="doc_date" class="label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
              <input id="doc_date" type="date" class="input" required>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="input-group">
                <label for="employee_name" class="label">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</label>
                <input id="employee_name" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•" class="input" required>
              </div>
              <div class="input-group">
                <label for="employee_code" class="label">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
                <input id="employee_code" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô" class="input" required>
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="input-group">
                <label for="position" class="label">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                <input id="position" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á" class="input" required>
              </div>
              <div class="input-group">
                <label for="department" class="label">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
                <input id="department" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô" class="input" required>
              </div>
            </div>
            <div class="input-group">
              <label for="division" class="label">‡∏ù‡πà‡∏≤‡∏¢</label>
              <input id="division" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ù‡πà‡∏≤‡∏¢" class="input" required>
            </div>
          </div>
        </div>
        <div class="form-section">
          <h3 class="form-section-title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î</h3>
          <div class="grid grid-cols-1 gap-4">
            <div class="input-group">
              <label class="label">‡∏´‡∏°‡∏ß‡∏î/‡∏Ç‡πâ‡∏≠/‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö/‡∏´‡∏ô‡πâ‡∏≤</label>
              <div class="grid-4">
                <input id="rule_section" placeholder="‡∏´‡∏°‡∏ß‡∏î" class="input">
                <input id="rule_clause" placeholder="‡∏Ç‡πâ‡∏≠" class="input">
                <input id="rule_parentheses" placeholder="‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö" class="input">
                <input id="rule_page" placeholder="‡∏´‡∏ô‡πâ‡∏≤" class="input">
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="input-group">
                <label for="place" class="label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</label>
                <input id="place" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà" class="input" required>
              </div>
              <div class="input-group">
                <label for="offense_date" class="label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î</label>
                <input id="offense_date" type="date" class="input" required>
              </div>
            </div>
            <div class="input-group">
              <label for="offense_description" class="label">‡∏´‡∏°‡∏ß‡∏î‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡πÇ‡∏ó‡∏©‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ô‡∏±‡∏¢</label>
              <textarea id="offense_description" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏ß‡∏¥‡∏ô‡∏±‡∏¢..." class="input h-24" required></textarea>
            </div>
          </div>
        </div>
        <div class="form-section">
          <h3 class="form-section-title">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©</h3>
          <div class="grid grid-cols-1 gap-4">
            <div class="input-group">
              <label for="punishment_type" class="label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©</label>
              <select id="punishment_type" class="input" required>
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏© --</option>
                <option value="‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏≤‡∏à‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠">‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏≤‡∏à‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</option>
                <option value="‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≤‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏≠‡∏±‡∏Å‡∏©‡∏£">‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≤‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏≠‡∏±‡∏Å‡∏©‡∏£</option>
                <option value="‡∏ï‡∏±‡∏î‡πÇ‡∏ö‡∏ô‡∏±‡∏™/‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ">‡∏ï‡∏±‡∏î‡πÇ‡∏ö‡∏ô‡∏±‡∏™/‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ</option>
                <option value="‡∏û‡∏±‡∏Å‡∏á‡∏≤‡∏ô">‡∏û‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option>
                <option value="‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á">‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á</option>
              </select>
            </div>
            <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏±‡∏Å‡∏á‡∏≤‡∏ô -->
            <div id="suspensionDetails" class="space-y-3 p-4 bg-blue-50 rounded border border-blue-200 hidden">
              <h4 class="font-semibold mb-2 text-lg">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h4>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="input-group">
                  <label for="suspension_days" class="label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô</label>
                  <input id="suspension_days" type="number" min="1" max="7" placeholder="1-7" class="input" required>
                </div>
                <div class="input-group">
                  <label for="suspension_start" class="label">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                  <input id="suspension_start" type="date" class="input" required>
                </div>
                <div class="input-group">
                  <label for="suspension_end" class="label">‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                  <input id="suspension_end" type="date" class="input" required>
                </div>
              </div>
            </div>
            <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á -->
            <div id="terminationDetails" class="space-y-3 p-4 bg-blue-50 rounded border border-blue-200 hidden">
              <h4 class="font-semibold mb-2 text-lg">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á</h4>
              <div class="input-group">
                <label for="termination_date" class="label">‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà</label>
                <input id="termination_date" type="date" class="input" required>
              </div>
            </div>
            <div class="input-group">
              <label for="punishment_detail" class="label">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</label>
              <textarea id="punishment_detail" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..." class="input h-20"></textarea>
            </div>
          </div>
        </div>
        <!-- ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô -->
        <div class="form-section">
          <h3 class="form-section-title">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</h3>
          <div class="signature-tutorial">
            <div class="signature-tutorial-title">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
              </svg>
              ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô
            </div>
            <ul class="signature-tutorial-list">
              <li class="signature-tutorial-item">‡∏•‡∏≤‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏ô‡∏¥‡πâ‡∏ß‡∏•‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß</li>
              <li class="signature-tutorial-item">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</li>
              <li class="signature-tutorial-item">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏•‡πâ‡∏≤‡∏á" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏ö‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏ã‡πá‡∏ô‡πÉ‡∏´‡∏°‡πà</li>
              <li class="signature-tutorial-item">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 4 ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF</li>
            </ul>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
            <!-- ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô -->
            <div>
              <label class="label">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô</label>
              <div class="signature-pad-container" id="supervisor_signature_container">
                <canvas id="supervisor_signature_pad" class="signature-pad"></canvas>
                <div class="signature-controls">
                  <button type="button" id="clear_supervisor" class="signature-btn clear">‡∏•‡πâ‡∏≤‡∏á</button>
                  <button type="button" id="save_supervisor" class="signature-btn save">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
                <div class="signature-status" id="supervisor_status">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</div>
                <div class="signature-quality-notice">‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô</div>
              </div>
            </div>
            <!-- ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢ -->
            <div>
              <label class="label">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢</label>
              <div class="signature-pad-container" id="manager_signature_container">
                <canvas id="manager_signature_pad" class="signature-pad"></canvas>
                <div class="signature-controls">
                  <button type="button" id="clear_manager" class="signature-btn clear">‡∏•‡πâ‡∏≤‡∏á</button>
                  <button type="button" id="save_manager" class="signature-btn save">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
                <div class="signature-status" id="manager_status">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</div>
                <div class="signature-quality-notice">‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô</div>
              </div>
            </div>
            <!-- ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô -->
            <div>
              <label class="label">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
              <div class="signature-pad-container" id="employee_signature_container">
                <canvas id="employee_signature_pad" class="signature-pad"></canvas>
                <div class="signature-controls">
                  <button type="button" id="clear_employee" class="signature-btn clear">‡∏•‡πâ‡∏≤‡∏á</button>
                  <button type="button" id="save_employee" class="signature-btn save">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
                <div class="signature-status" id="employee_status">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</div>
                <div class="signature-quality-notice">‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô</div>
              </div>
            </div>
            <!-- ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢ HR -->
            <div>
              <label class="label">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢ HR</label>
              <div class="signature-pad-container" id="hr_signature_container">
                <canvas id="hr_signature_pad" class="signature-pad"></canvas>
                <div class="signature-controls">
                  <button type="button" id="clear_hr" class="signature-btn clear">‡∏•‡πâ‡∏≤‡∏á</button>
                  <button type="button" id="save_hr" class="signature-btn save">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
                <div class="signature-status" id="hr_status">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</div>
                <div class="signature-quality-notice">‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô</div>
              </div>
            </div>
          </div>
        </div>
        <div class="note-box">
          <p class="font-medium mb-1">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</p>
          <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ PDF</p>
        </div>
        <div class="btn-group">
          <button type="button" id="btnPreview" class="btn btn-primary flex-1 md:flex-none">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï</button>
          <button type="button" id="btnSaveSheet" class="btn btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Google Sheet</button>
          <button type="button" id="btnPDF" class="btn btn-secondary flex-1 md:flex-none">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF</button>
          <button type="button" id="btnShare" class="btn btn-secondary flex-1 md:flex-none">üåê ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå</button>
          <button type="button" id="btnReset" class="btn btn-danger flex-1 md:flex-none">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
      </form>
    </div>
    <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á -->
    <div class="card">
      <h2 class="section-title">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
        ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
      </h2>
      <div id="contractPreview" class="a4 contract-content">
        <div class="content-wrapper"></div>
      </div>
    </div>
  </div>
</div>
<!-- Notification Container -->
<div id="notification" class="notification"></div>
<script>
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ DOM
const $ = id => document.getElementById(id);
// ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô (‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô path data ‡∏Ç‡∏≠‡∏á signature pad)
let signatures = { 
  supervisor: null, 
  manager: null, 
  employee: null, 
  hr: null 
};
// ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö instance ‡∏Ç‡∏≠‡∏á signature pad
let signaturePads = {
  supervisor: null,
  manager: null,
  employee: null,
  hr: null
};
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
function dateTH(d) {
  if (!d) return "........";
  const date = new Date(d);
  const thaiMonths = ['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô', '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'];
  return `${date.getDate()} ${thaiMonths[date.getMonth()]} ${date.getFullYear() + 543}`;
}
function formatDate(d) {
  if (!d) return ".......";
  try {
    const date = new Date(d);
    if (isNaN(date.getTime())) return ".......";
    return `${String(date.getDate()).padStart(2, '0')}/${String(date.getMonth() + 1).padStart(2, '0')}/${date.getFullYear() + 543}`;
  } catch (e) {
    return ".......";
  }
}
// ‡πÅ‡∏™‡∏î‡∏á notification
function showNotification(message, type = 'success') {
  const notification = $('notification');
  notification.textContent = message;
  notification.className = `notification ${type} show`;
  setTimeout(() => {
    notification.classList.remove('show');
  }, 3000);
}
// ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
function getFormData() {
  return {
    doc_date: $("doc_date")?.value || "",
    employee_name: $("employee_name")?.value || "",
    employee_code: $("employee_code")?.value || "",
    position: $("position")?.value || "",
    department: $("department")?.value || "",
    division: $("division")?.value || "",
    rule_section: $("rule_section")?.value || "",
    rule_clause: $("rule_clause")?.value || "",
    rule_parentheses: $("rule_parentheses")?.value || "",
    rule_page: $("rule_page")?.value || "",
    place: $("place")?.value || "",
    offense_date: $("offense_date")?.value || "",
    offense_description: $("offense_description")?.value || "",
    punishment_type: $("punishment_type")?.value || "",
    suspension_days: $("suspension_days")?.value || "",
    suspension_start: $("suspension_start")?.value || "",
    suspension_end: $("suspension_end")?.value || "",
    termination_date: $("termination_date")?.value || "",
    punishment_detail: $("punishment_detail")?.value || "",
    signatures: signatures
  };
}
// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
function validateForm() {
  const requiredFields = [
    "doc_date", "employee_name", "employee_code", "position", 
    "department", "division", "place", "offense_date", 
    "offense_description", "punishment_type"
  ];
  const missingFields = [];
  requiredFields.forEach(field => {
    if (!$(field).value.trim()) {
      missingFields.push(field);
      $(field).style.borderColor = '#dc2626';
    } else {
      $(field).style.borderColor = '#cbd5e1';
    }
  });
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏¢‡πà‡∏≠‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ö‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
  const punishmentType = $("punishment_type").value;
  if (punishmentType === "‡∏û‡∏±‡∏Å‡∏á‡∏≤‡∏ô") {
    if (!$("suspension_days").value.trim()) {
      missingFields.push("suspension_days");
      $("suspension_days").style.borderColor = '#dc2626';
    } else {
      $("suspension_days").style.borderColor = '#cbd5e1';
    }
    if (!$("suspension_start").value.trim()) {
      missingFields.push("suspension_start");
      $("suspension_start").style.borderColor = '#dc2626';
    } else {
      $("suspension_start").style.borderColor = '#cbd5e1';
    }
    if (!$("suspension_end").value.trim()) {
      missingFields.push("suspension_end");
      $("suspension_end").style.borderColor = '#dc2626';
    } else {
      $("suspension_end").style.borderColor = '#cbd5e1';
    }
  } else if (punishmentType === "‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á") {
    if (!$("termination_date").value.trim()) {
      missingFields.push("termination_date");
      $("termination_date").style.borderColor = '#dc2626';
    } else {
      $("termination_date").style.borderColor = '#cbd5e1';
    }
  }
  if (missingFields.length > 0) {
    showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
    return false;
  }
  return true;
}
// ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
function renderContract() {
  const d = getFormData();
  let suspensionText = "‡∏û‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ .... ‡∏ß‡∏±‡∏ô ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 7 ‡∏ß‡∏±‡∏ô) ‡πÄ‡∏£‡∏¥‡πà‡∏° ....... ‡∏ñ‡∏∂‡∏á .......";
  let terminationText = "‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà .......";
  if (d.punishment_type === "‡∏û‡∏±‡∏Å‡∏á‡∏≤‡∏ô") {
    const days = d.suspension_days ? d.suspension_days : "....";
    const start = d.suspension_start ? formatDate(d.suspension_start) : ".......";
    const end = d.suspension_end ? formatDate(d.suspension_end) : ".......";
    suspensionText = `‡∏û‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ ${days} ‡∏ß‡∏±‡∏ô ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 7 ‡∏ß‡∏±‡∏ô) ‡πÄ‡∏£‡∏¥‡πà‡∏° ${start} ‡∏ñ‡∏∂‡∏á ${end}`;
  }
  if (d.punishment_type === "‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á") {
    const termination = d.termination_date ? formatDate(d.termination_date) : ".......";
    terminationText = `‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${termination}`;
  }
  const today = new Date();
  const signatureDate = `${String(today.getDate()).padStart(2, '0')}/${String(today.getMonth() + 1).padStart(2, '0')}/${today.getFullYear() + 543}`;
  const preview = $("contractPreview");
  if (preview) {
    const contentWrapper = preview.querySelector('.content-wrapper');
    if (contentWrapper) {
      contentWrapper.innerHTML = `
        <div class="government-letter">
          <div class="letter-header">
            <div class="letter-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ô‡∏±‡∏¢</div>
          </div>
          <div class="letter-date">
            ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${dateTH(d.doc_date)}
          </div>
          <div class="letter-content">
            <div class="letter-paragraph">
              ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å <span class="font-bold">${d.employee_name || "................"}</span> 
              ‡∏£‡∏´‡∏±‡∏™ <span class="font-bold">${d.employee_code || "........"}</span> 
              ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á <span class="font-bold">${d.position || "........"}</span>
              ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô <span class="font-bold">${d.department || "........"}</span> 
              ‡∏ù‡πà‡∏≤‡∏¢ <span class="font-bold">${d.division || "........"}</span>
            </div>
            <div class="letter-paragraph">
              ‡πÑ‡∏î‡πâ‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà <span class="font-bold">${d.rule_section || "........"}</span> 
              ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà <span class="font-bold">${d.rule_clause || "........"}</span> 
              ‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö‡∏ó‡∏µ‡πà <span class="font-bold">${d.rule_parentheses || "........"}</span> 
              ‡∏´‡∏ô‡πâ‡∏≤ <span class="font-bold">${d.rule_page || "........"}</span>
            </div>
            <div class="letter-paragraph">
              ‡∏´‡∏°‡∏ß‡∏î‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡πÇ‡∏ó‡∏©‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ô‡∏±‡∏¢ ‡∏ß‡πà‡∏≤‡∏î‡πâ‡∏ß‡∏¢ <span class="font-bold">${d.offense_description || "........................................"}</span>
            </div>
            <div class="letter-paragraph">
              ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà <span class="font-bold">${d.place || "........"}</span> 
              ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <span class="font-bold">${dateTH(d.offense_date)}</span>
            </div>
            <div class="letter-paragraph">
              ‡∏ã‡∏∂‡πà‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ó‡∏µ‡πà‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ß‡πà‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø 
              ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡∏â‡∏ö‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡∏ó‡πà‡∏≤‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß ‡∏Ñ‡∏∑‡∏≠
            </div>
            <div class="letter-section">
              <div class="letter-list">
                <div class="letter-list-item">
                  <input type="checkbox" id="punish_warn_verbal" class="sr-only" ${d.punishment_type === "‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏≤‡∏à‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠" ? "checked" : ""}>
                  <label for="punish_warn_verbal" class="official-checkbox-label">
                    <span class="official-checkbox-indicator"></span>
                    ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏≤‡∏à‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠
                  </label>
                </div>
                <div class="letter-list-item">
                  <input type="checkbox" id="punish_warn_written" class="sr-only" ${d.punishment_type === "‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≤‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏≠‡∏±‡∏Å‡∏©‡∏£" ? "checked" : ""}>
                  <label for="punish_warn_written" class="official-checkbox-label">
                    <span class="official-checkbox-indicator"></span>
                    ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≤‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏≠‡∏±‡∏Å‡∏©‡∏£
                  </label>
                </div>
                <div class="letter-list-item">
                  <input type="checkbox" id="punish_bonus_cut" class="sr-only" ${d.punishment_type === "‡∏ï‡∏±‡∏î‡πÇ‡∏ö‡∏ô‡∏±‡∏™/‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ" ? "checked" : ""}>
                  <label for="punish_bonus_cut" class="official-checkbox-label">
                    <span class="official-checkbox-indicator"></span>
                    ‡∏ï‡∏±‡∏î‡πÇ‡∏ö‡∏ô‡∏±‡∏™ / ‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ
                  </label>
                </div>
                <div class="letter-list-item">
                  <input type="checkbox" id="punish_suspend" class="sr-only" ${d.punishment_type === "‡∏û‡∏±‡∏Å‡∏á‡∏≤‡∏ô" ? "checked" : ""}>
                  <label for="punish_suspend" class="official-checkbox-label">
                    <span class="official-checkbox-indicator"></span>
                    ${suspensionText}
                  </label>
                </div>
                <div class="letter-list-item">
                  <input type="checkbox" id="punish_terminate" class="sr-only" ${d.punishment_type === "‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á" ? "checked" : ""}>
                  <label for="punish_terminate" class="official-checkbox-label">
                    <span class="official-checkbox-indicator"></span>
                    ${terminationText}
                  </label>
                </div>
              </div>
            </div>
            <div class="letter-paragraph">
              ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î): <span class="font-bold">${d.punishment_detail || ".................................................."}</span>
            </div>
            <div class="letter-paragraph">
              ‡∏´‡∏≤‡∏Å‡∏ó‡πà‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î‡∏ã‡πâ‡∏≥ / ‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô / ‡∏°‡∏µ‡πÄ‡∏à‡∏ï‡∏ô‡∏≤‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÑ‡∏°‡πà‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø 
              ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏Å‡∏£‡∏ì‡∏µ‡πÉ‡∏î‡πÜ ‡∏ó‡πà‡∏≤‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡∏ï‡πà‡∏≠‡πÑ‡∏õ
            </div>
            <div class="letter-signature-section">
              <div class="signature-grid">
                <div class="signature-item">
                  <div class="signature-box-print ${signatures.supervisor ? 'has-signature' : ''}">
                    ${signatures.supervisor ? `<img src="${signaturePads.supervisor.toDataURL()}" alt="‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô" style="max-height:70px;"/>` : ''}
                  </div>
                  <div class="signature-label">(‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠) ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô</div>
                  <div class="signature-date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${signatureDate}</div>
                </div>
                <div class="signature-item">
                  <div class="signature-box-print ${signatures.manager ? 'has-signature' : ''}">
                    ${signatures.manager ? `<img src="${signaturePads.manager.toDataURL()}" alt="‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢" style="max-height:70px;"/>` : ''}
                  </div>
                  <div class="signature-label">(‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠) ‡∏ú‡∏à‡∏Å./‡∏ú‡∏ä.‡∏ú‡∏à‡∏Å.‡∏ù‡πà‡∏≤‡∏¢</div>
                  <div class="signature-date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${signatureDate}</div>
                </div>
              </div>
              <div class="letter-section-title" style="margin-top: 30px;">‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
              <div class="letter-paragraph">
                ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤ <span class="font-bold">${d.employee_name || "................"}</span> 
                ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <span class="font-bold">${dateTH(d.doc_date) || "........"}</span> 
                ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏à‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
              </div>
              <div class="letter-paragraph">
                ‡∏Å‡∏£‡∏ì‡∏µ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏Å‡∏£‡∏ì‡∏µ‡πÉ‡∏î ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø 
                ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Ç‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡∏≠‡∏µ‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏£‡πâ‡∏≠‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÉ‡∏î‡πÜ
              </div>
              <div class="signature-grid">
                <div class="signature-item">
                  <div class="signature-box-print ${signatures.employee ? 'has-signature' : ''}">
                    ${signatures.employee ? `<img src="${signaturePads.employee.toDataURL()}" alt="‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô" style="max-height:70px;"/>` : ''}
                  </div>
                  <div class="signature-label">(‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠) ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
                  <div class="signature-date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${signatureDate}</div>
                </div>
                <div class="signature-item">
                  <div class="signature-box-print ${signatures.hr ? 'has-signature' : ''}">
                    ${signatures.hr ? `<img src="${signaturePads.hr.toDataURL()}" alt="‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢ HR" style="max-height:70px;"/>` : ''}
                  </div>
                  <div class="signature-label">(‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠) ‡∏ú‡∏à‡∏Å./‡∏ú‡∏ä.‡∏ú‡∏à‡∏Å.‡∏ù‡πà‡∏≤‡∏¢ HR</div>
                  <div class="signature-date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${signatureDate}</div>
                </div>
              </div>
            </div>
            <div class="official-advice">
              <div class="official-advice-title">‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</div>
              <div class="advice-list">
                <div class="official-advice-item">1. ‡∏Å‡∏£‡∏ì‡∏µ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô</div>
                <div class="official-advice-item">2. ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≤‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏° ‡∏°‡∏µ‡∏ú‡∏•‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏ä‡∏î‡πÄ‡∏ä‡∏¢‡πÉ‡∏î‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</div>
                <div class="official-advice-item">3. ‡πÉ‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡∏ú‡∏• 1 ‡∏õ‡∏µ ‡∏ô‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î</div>
                <div class="official-advice-item">4. ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏û‡∏¥‡∏û‡∏≤‡∏ó ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏™‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢</div>
              </div>
            </div>
          </div>
        </div>
      `;
    }
  }
}
// ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF
async function downloadPDF() {
  const missingSignatures = [];
  if (!signatures.supervisor) missingSignatures.push("‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô");
  if (!signatures.manager) missingSignatures.push("‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢");
  if (!signatures.employee) missingSignatures.push("‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô");
  if (!signatures.hr) missingSignatures.push("‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢ HR");
  if (missingSignatures.length > 0) {
    showNotification(`‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á (${missingSignatures.join(", ")})`, 'error');
    return;
  }
  const btnPDF = $("btnPDF");
  btnPDF.disabled = true;
  btnPDF.innerHTML = '<span class="spinner"></span> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á PDF...';
  try {
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á element ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á PDF
    const tempContainer = document.createElement('div');
    tempContainer.style.width = '210mm';
    tempContainer.style.minHeight = '297mm';
    tempContainer.style.padding = '15mm';
    tempContainer.style.boxSizing = 'border-box';
    tempContainer.style.backgroundColor = '#fff';
    tempContainer.style.position = 'absolute';
    tempContainer.style.left = '-9999px';
    tempContainer.style.fontFamily = "'Sarabun', sans-serif";
    tempContainer.style.fontSize = '14px'; // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö PDF
    // ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
    const content = $("contractPreview").querySelector('.content-wrapper').cloneNode(true);
    tempContainer.appendChild(content);
    document.body.appendChild(tempContainer);
    const canvas = await html2canvas(tempContainer, { 
      scale: 2, 
      backgroundColor: '#fff',
      useCORS: true,
      logging: false
    });
    // ‡∏•‡∏ö element ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
    document.body.removeChild(tempContainer);
    const imgData = canvas.toDataURL("image/png", 1.0);
    const pdf = new jspdf.jsPDF({ 
      unit: 'mm', 
      format: 'a4',
      orientation: 'portrait'
    });
    const pdfWidth = pdf.internal.pageSize.getWidth();
    const pdfHeight = pdf.internal.pageSize.getHeight();
    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ A4
    const imgProps = pdf.getImageProperties(imgData);
    const imgRatio = imgProps.width / imgProps.height;
    let imgWidth = pdfWidth;
    let imgHeight = imgWidth / imgRatio;
    // ‡∏ñ‡πâ‡∏≤‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤ A4 ‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á
    if (imgHeight > pdfHeight) {
      imgHeight = pdfHeight;
      imgWidth = imgHeight * imgRatio;
    }
    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤
    const x = (pdfWidth - imgWidth) / 2;
    const y = (pdfHeight - imgHeight) / 2;
    pdf.addImage(imgData, 'PNG', x, y, imgWidth, imgHeight);
    const employeeName = $("employee_name").value || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏";
    pdf.save(`‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©_${employeeName}.pdf`);
    showNotification("‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
  } catch (error) {
    console.error("Error generating PDF:", error);
    showNotification("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á PDF", 'error');
  } finally {
    btnPDF.disabled = false;
    btnPDF.textContent = "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF";
  }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
function compressData(str) {
  try {
    const compressed = btoa(unescape(encodeURIComponent(str)));
    return compressed;
  } catch (e) {
    console.error('Compression error:', e);
    return null;
  }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
function decompressData(compressed) {
  try {
    return decodeURIComponent(escape(atob(compressed)));
  } catch (e) {
    console.error('Decompression error:', e);
    return null;
  }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏õ‡∏ï‡∏≤‡∏°)
function generateShareLink() {
  try {
    const data = getFormData();
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠ (‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)
    const compactData = {
      // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
      dd: data.doc_date,
      en: data.employee_name,
      ec: data.employee_code,
      ps: data.position,
      dp: data.department,
      dv: data.division,
      // ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î
      rs: data.rule_section,
      rc: data.rule_clause,
      rp: data.rule_parentheses,
      rpg: data.rule_page,
      pl: data.place,
      od: data.offense_date,
      ods: data.offense_description,
      // ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©
      pt: data.punishment_type,
      sd: data.suspension_days,
      ss: data.suspension_start,
      se: data.suspension_end,
      td: data.termination_date,
      pd: data.punishment_detail,
      // ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô (‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î‡πÅ‡∏¢‡∏Å) - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
      sig: {
        sv: data.signatures.supervisor || null,
        mg: data.signatures.manager || null,
        em: data.signatures.employee || null,
        hr: data.signatures.hr || null
      }
    };
    // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô JSON ‡πÅ‡∏•‡∏∞‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î
    const jsonData = JSON.stringify(compactData);
    const encodedData = btoa(unescape(encodeURIComponent(jsonData)));
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î URL
    const baseUrl = `${window.location.origin}${window.location.pathname}`;
    const fullUrl = `${baseUrl}?d=${encodedData}`;
    if (fullUrl.length > 2000) {
      // ‡∏ñ‡πâ‡∏≤ URL ‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Short URL ID
      const shortId = generateShortId();
      saveToSessionStorage(shortId, data); // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÉ‡∏ä‡πâ sessionStorage ‡πÅ‡∏ó‡∏ô localStorage
      const shortUrl = `${baseUrl}?id=${shortId}`;
      // ‡∏™‡∏£‡πâ‡∏≤‡∏á modal ‡πÅ‡∏™‡∏î‡∏á URL ‡πÅ‡∏•‡∏∞ QR Code
      showShareModal(shortUrl, shortId);
    } else {
      // URL ‡∏Ç‡∏ô‡∏≤‡∏î‡∏õ‡∏Å‡∏ï‡∏¥
      copyToClipboard(fullUrl);
    }
  } catch (error) {
    console.error("Error generating share link:", error);
    showNotification("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå", 'error');
  }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á Short ID
function generateShortId() {
  const timestamp = Date.now().toString(36);
  const random = Math.random().toString(36).substr(2, 5);
  return `${timestamp}-${random}`;
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô SessionStorage (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö demo) - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
function saveToSessionStorage(id, data) {
  try {
    // ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏Ñ‡∏ß‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    const storage = JSON.parse(sessionStorage.getItem('sharedDocs') || '{}');
    storage[id] = {
      data: data,
      created: new Date().toISOString(),
      expires: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString() // 7 ‡∏ß‡∏±‡∏ô
    };
    sessionStorage.setItem('sharedDocs', JSON.stringify(storage));
  } catch (e) {
    console.error('Storage error:', e);
  }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å URL ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏õ‡∏ï‡∏≤‡∏°)
function loadFromUrl() {
  try {
    const urlParams = new URLSearchParams(window.location.search);
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö Short ID ‡∏Å‡πà‡∏≠‡∏ô
    const shortId = urlParams.get('id');
    if (shortId) {
      loadFromShortId(shortId);
      return;
    }
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö data parameter
    const dataParam = urlParams.get('d');
    if (dataParam) {
      const decodedData = decodeURIComponent(escape(atob(dataParam)));
      const compactData = JSON.parse(decodedData);
      // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ï‡πá‡∏°
      const fullData = {
        doc_date: compactData.dd || '',
        employee_name: compactData.en || '',
        employee_code: compactData.ec || '',
        position: compactData.ps || '',
        department: compactData.dp || '',
        division: compactData.dv || '',
        rule_section: compactData.rs || '',
        rule_clause: compactData.rc || '',
        rule_parentheses: compactData.rp || '',
        rule_page: compactData.rpg || '',
        place: compactData.pl || '',
        offense_date: compactData.od || '',
        offense_description: compactData.ods || '',
        punishment_type: compactData.pt || '',
        suspension_days: compactData.sd || '',
        suspension_start: compactData.ss || '',
        suspension_end: compactData.se || '',
        termination_date: compactData.td || '',
        punishment_detail: compactData.pd || '',
        signatures: {
          supervisor: compactData.sig?.sv || null,
          manager: compactData.sig?.mg || null,
          employee: compactData.sig?.em || null,
          hr: compactData.sig?.hr || null
        }
      };
      loadDataToForm(fullData);
      showNotification("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
    }
  } catch (error) {
    console.error("Error loading data from URL:", error);
    showNotification("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏î‡πâ", 'error');
  }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Short ID - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
function loadFromShortId(id) {
  try {
    const storage = JSON.parse(sessionStorage.getItem('sharedDocs') || '{}'); // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÉ‡∏ä‡πâ sessionStorage
    const doc = storage[id];
    if (doc) {
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏
      if (new Date(doc.expires) < new Date()) {
        showNotification("‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß", 'error');
        return;
      }
      loadDataToForm(doc.data);
      showNotification("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
    } else {
      showNotification("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ (‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á)", 'error'); // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢
    }
  } catch (error) {
    console.error("Error loading from short ID:", error);
    showNotification("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", 'error');
  }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á)
function loadDataToForm(data) {
  // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏≠‡∏£‡πå‡∏°
  Object.keys(data).forEach(key => {
    if (key !== 'signatures' && $(key)) {
      $(key).value = data[key] || '';
    }
  });
  // ‡πÇ‡∏´‡∏•‡∏î‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞)
  if (data.signatures) {
    signatures = { ...data.signatures };
    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô
    Object.keys(signatures).forEach(key => {
      if (signatures[key]) {
        $(`${key}_status`).textContent = "‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß";
        $(`${key}_status`).classList.add('signed');
        // ‡∏ß‡∏≤‡∏î‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏•‡∏á‡πÉ‡∏ô canvas ‡∏î‡πâ‡∏ß‡∏¢ - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÉ‡∏ä‡πâ fromData
        if (signaturePads[key] && signatures[key]) {
          signaturePads[key].fromData(signatures[key]);
        }
      } else {
        $(`${key}_status`).textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà";
        $(`${key}_status`).classList.remove('signed');
      }
    });
  }
  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
  handlePunishmentTypeChange();
  renderContract();
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á Clipboard
function copyToClipboard(text) {
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á textarea ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
  const textarea = document.createElement('textarea');
  textarea.value = text;
  textarea.style.position = 'fixed';
  textarea.style.opacity = '0';
  document.body.appendChild(textarea);
  textarea.select();
  try {
    document.execCommand('copy');
    showNotification("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
  } catch (err) {
    // Fallback to navigator.clipboard
    navigator.clipboard.writeText(text).then(() => {
      showNotification("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
    }).catch(err => {
      showNotification("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏î‡πâ", 'error');
    });
  } finally {
    document.body.removeChild(textarea);
  }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ä‡∏£‡πå
function showShareModal(url, shortId) {
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Modal HTML
  const modalHtml = `
    <div id="shareModal" style="
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    ">
      <div style="
        background: white;
        padding: 2rem;
        border-radius: 1rem;
        max-width: 500px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
      ">
        <h3 style="margin-bottom: 1rem; font-size: 1.5rem; font-weight: bold;">
          ‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
        </h3>
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
            ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå (‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô)
          </label>
          <div style="display: flex; gap: 0.5rem;">
            <input 
              type="text" 
              value="${url}" 
              readonly 
              id="shareUrlInput"
              style="
                flex: 1;
                padding: 0.5rem;
                border: 1px solid #cbd5e1;
                border-radius: 0.375rem;
                font-size: 0.875rem;
              "
            />
            <button 
              onclick="copyShareUrl()"
              style="
                padding: 0.5rem 1rem;
                background: #3b82f6;
                color: white;
                border: none;
                border-radius: 0.375rem;
                cursor: pointer;
                font-weight: 600;
              "
            >
              ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å
            </button>
          </div>
        </div>
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
            ‡∏£‡∏´‡∏±‡∏™‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á
          </label>
          <div style="
            padding: 0.75rem;
            background: #f3f4f6;
            border-radius: 0.375rem;
            font-family: monospace;
            font-size: 1.125rem;
            text-align: center;
            font-weight: bold;
          ">
            ${shortId}
          </div>
        </div>
        <div style="
          padding: 1rem;
          background: #fef3c7;
          border: 1px solid #fde68a;
          border-radius: 0.375rem;
          margin-bottom: 1rem;
        ">
          <p style="font-size: 0.875rem; color: #92400e;">
            <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
          </p>
        </div>
        <button 
          onclick="closeShareModal()"
          style="
            width: 100%;
            padding: 0.75rem;
            background: #6b7280;
            color: white;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-weight: 600;
          "
        >
          ‡∏õ‡∏¥‡∏î
        </button>
      </div>
    </div>
  `;
  // ‡πÅ‡∏™‡∏î‡∏á Modal
  document.body.insertAdjacentHTML('beforeend', modalHtml);
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL ‡∏à‡∏≤‡∏Å Modal
window.copyShareUrl = function() {
  const input = document.getElementById('shareUrlInput');
  input.select();
  document.execCommand('copy');
  showNotification("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏¥‡∏î Modal
window.closeShareModal = function() {
  const modal = document.getElementById('shareModal');
  if (modal) {
    modal.remove();
  }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô
function setupSignaturePad(canvasId, saveBtnId, clearBtnId, statusId, signatureKey) {
  const canvas = $(canvasId);
  const saveBtn = $(saveBtnId);
  const clearBtn = $(clearBtnId);
  const status = $(statusId);
  function resizeCanvas() {
    const container = canvas.parentElement;
    const ratio = Math.max(window.devicePixelRatio || 1, 1);
    canvas.width = container.offsetWidth * ratio;
    canvas.height = 150 * ratio;
    canvas.style.width = container.offsetWidth + 'px';
    canvas.style.height = '150px';
    const ctx = canvas.getContext("2d");
    ctx.scale(ratio, ratio);
    ctx.fillStyle = 'rgb(255, 255, 255)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  }
  signaturePads[signatureKey] = new SignaturePad(canvas, {
    backgroundColor: 'rgb(255, 255, 255)',
    penColor: 'rgb(0, 0, 0)',
    minWidth: 1.5,
    maxWidth: 2.5,
    throttle: 16
  });
  resizeCanvas();
  window.addEventListener('resize', resizeCanvas);
  clearBtn.addEventListener('click', () => {
    signaturePads[signatureKey].clear();
    signatures[signatureKey] = null;
    status.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà";
    status.classList.remove('signed');
    renderContract();
  });
  saveBtn.addEventListener('click', () => {
    if (signaturePads[signatureKey].isEmpty()) {
      showNotification(`‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á ${signatureKey}`, 'error');
      return;
    }
    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏°‡∏ä‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô
    const originalData = signaturePads[signatureKey].toData();
    signaturePads[signatureKey].fromData(originalData.map(stroke => {
      return {
        ...stroke,
        points: stroke.points.map(point => ({
          ...point,
          time: point.time * 0.8
        }))
      };
    }));
    // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô path data ‡πÅ‡∏ó‡∏ô DataURL
    signatures[signatureKey] = signaturePads[signatureKey].toData();
    status.textContent = "‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß";
    status.classList.add('signed');
    renderContract();
    showNotification(`${signatureKey === 'supervisor' ? '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô' : 
                     signatureKey === 'manager' ? '‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢' :
                     signatureKey === 'employee' ? '‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô' :
                     '‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢ HR'} ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`);
  });
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©
function handlePunishmentTypeChange() {
  const punishmentType = $("punishment_type").value;
  const suspensionDetails = $("suspensionDetails");
  const terminationDetails = $("terminationDetails");
  suspensionDetails.classList.add('hidden');
  terminationDetails.classList.add('hidden');
  if (punishmentType === "‡∏û‡∏±‡∏Å‡∏á‡∏≤‡∏ô") {
    suspensionDetails.classList.remove('hidden');
  } else if (punishmentType === "‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á") {
    terminationDetails.classList.remove('hidden');
  }
  renderContract();
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
function resetForm() {
  if (Object.values(signatures).some(sig => sig !== null)) {
    if (!confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ?')) {
      return;
    }
  }
  $("contractForm").reset();
  signatures = { supervisor: null, manager: null, employee: null, hr: null };
  Object.keys(signaturePads).forEach(key => {
    if (signaturePads[key]) {
      signaturePads[key].clear();
    }
    $(`${key}_status`).textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà";
    $(`${key}_status`).classList.remove('signed');
  });
  $("suspensionDetails").classList.add('hidden');
  $("terminationDetails").classList.add('hidden');
  renderContract();
  showNotification("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
}
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwX-zibsF9hi4iUILGA5UmzlpZy4nPphMId4qkHc1hqve3e_rnkxp7pthDY7HBLslW0/exec"; // ‡∏ß‡∏≤‡∏á URL ‡∏à‡∏≤‡∏Å Apps Script
document.getElementById("btnSaveSheet").addEventListener("click", async () => {
  if (!validateForm()) return; 
  const formData = getFormData();
  const payload = {
  doc_date: formData.doc_date,
  employee_name: formData.employee_name,
  employee_code: formData.employee_code,
  position: formData.position,
  department: formData.department,
  division: formData.division,
  place: formData.place,
  offense_date: formData.offense_date,
  punishment_type: formData.punishment_type
};
  try {
    const res = await fetch(SCRIPT_URL, {
      method: "POST",
      body: JSON.stringify(payload),
      headers: { "Content-Type": "application/json" }
    });
    const result = await res.json();
    if (result.status === "success") {
      showNotification("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Google Sheet ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚úÖ");
    } else {
      showNotification("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + result.message, "error");
    }
  } catch (err) {
    console.error(err);
    showNotification("‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheet ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß", "error");
  }
});
// Event Listeners
document.addEventListener('DOMContentLoaded', function() {
  setupSignaturePad('supervisor_signature_pad', 'save_supervisor', 'clear_supervisor', 'supervisor_status', 'supervisor');
  setupSignaturePad('manager_signature_pad', 'save_manager', 'clear_manager', 'manager_status', 'manager');
  setupSignaturePad('employee_signature_pad', 'save_employee', 'clear_employee', 'employee_status', 'employee');
  setupSignaturePad('hr_signature_pad', 'save_hr', 'clear_hr', 'hr_status', 'hr');
  $("btnPreview").addEventListener("click", renderContract);
  $("btnPDF").addEventListener("click", async () => { 
    if (!validateForm()) return;
    await downloadPDF(); 
  });
  $("btnShare").addEventListener("click", () => {
    if (!validateForm()) return;
    generateShareLink(); // ‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà
  });
  $("btnReset").addEventListener("click", resetForm);
  $("punishment_type").addEventListener("change", handlePunishmentTypeChange);
  loadFromUrl();
  renderContract();
  if (!$("doc_date").value) {
    const today = new Date();
    const dateString = today.toISOString().split('T')[0];
    $("doc_date").value = dateString;
  }
});
// ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏î‡πâ‡∏ß‡∏¢ Enter
document.querySelectorAll('input, textarea, select').forEach(element => {
  element.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
      e.preventDefault();
    }
  });
});
</script>
</body>
</html>